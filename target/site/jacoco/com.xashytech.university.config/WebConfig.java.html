<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WebConfig.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Xashy Tech University Student Portal</a> &gt; <a href="index.source.html" class="el_package">com.xashytech.university.config</a> &gt; <span class="el_source">WebConfig.java</span></div><h1>WebConfig.java</h1><pre class="source lang-java linenums">package com.xashytech.university.config;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;

import javax.sql.DataSource;

/**
 * Spring MVC Configuration
 * Configures the web application context
 */
@Configuration
@EnableWebMvc
@ComponentScan(basePackages = &quot;com.xashytech.university&quot;)
@PropertySource(&quot;classpath:application.properties&quot;)
<span class="nc" id="L27">public class WebConfig implements WebMvcConfigurer {</span>

    @Value(&quot;${db.url:jdbc:h2:mem:testdb}&quot;)
    private String dbUrl;

    @Value(&quot;${db.username:sa}&quot;)
    private String dbUsername;

    @Value(&quot;${db.password:}&quot;)
    private String dbPassword;

    @Value(&quot;${db.driver:org.h2.Driver}&quot;)
    private String dbDriver;

    /**
     * Configure View Resolver for JSP pages
     */
    @Bean
    public ViewResolver viewResolver() {
<span class="nc" id="L46">        InternalResourceViewResolver resolver = new InternalResourceViewResolver();</span>
<span class="nc" id="L47">        resolver.setViewClass(JstlView.class);</span>
<span class="nc" id="L48">        resolver.setPrefix(&quot;/WEB-INF/views/&quot;);</span>
<span class="nc" id="L49">        resolver.setSuffix(&quot;.jsp&quot;);</span>
<span class="nc" id="L50">        return resolver;</span>
    }

    /**
     * Configure DataSource
     */
    @Bean
    public DataSource dataSource() {
<span class="nc" id="L58">        DriverManagerDataSource dataSource = new DriverManagerDataSource();</span>
<span class="nc" id="L59">        dataSource.setDriverClassName(dbDriver);</span>
<span class="nc" id="L60">        dataSource.setUrl(dbUrl);</span>
<span class="nc" id="L61">        dataSource.setUsername(dbUsername);</span>
<span class="nc" id="L62">        dataSource.setPassword(dbPassword);</span>
<span class="nc" id="L63">        return dataSource;</span>
    }

    /**
     * Configure JdbcTemplate
     */
    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource) {
<span class="nc" id="L71">        return new JdbcTemplate(dataSource);</span>
    }

    /**
     * Configure static resource handling
     */
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
<span class="nc" id="L79">        registry.addResourceHandler(&quot;/static/**&quot;)</span>
<span class="nc" id="L80">                .addResourceLocations(&quot;/static/&quot;);</span>
<span class="nc" id="L81">        registry.addResourceHandler(&quot;/css/**&quot;)</span>
<span class="nc" id="L82">                .addResourceLocations(&quot;/static/css/&quot;);</span>
<span class="nc" id="L83">        registry.addResourceHandler(&quot;/js/**&quot;)</span>
<span class="nc" id="L84">                .addResourceLocations(&quot;/static/js/&quot;);</span>
<span class="nc" id="L85">        registry.addResourceHandler(&quot;/images/**&quot;)</span>
<span class="nc" id="L86">                .addResourceLocations(&quot;/static/images/&quot;);</span>
<span class="nc" id="L87">    }</span>
}

/**
 * Application Configuration for different environments
 */
@Configuration
@PropertySource(&quot;classpath:application-${spring.profiles.active:dev}.properties&quot;)
<span class="nc" id="L95">class AppConfig {</span>

    /**
     * Database initialization for development
     */
    @Bean
    public DatabaseInitializer databaseInitializer(JdbcTemplate jdbcTemplate) {
<span class="nc" id="L102">        return new DatabaseInitializer(jdbcTemplate);</span>
    }

    /**
     * Database initializer class
     */
    public static class DatabaseInitializer {
        private final JdbcTemplate jdbcTemplate;

<span class="nc" id="L111">        public DatabaseInitializer(JdbcTemplate jdbcTemplate) {</span>
<span class="nc" id="L112">            this.jdbcTemplate = jdbcTemplate;</span>
<span class="nc" id="L113">            initializeDatabase();</span>
<span class="nc" id="L114">        }</span>

        private void initializeDatabase() {
            // Create students table
<span class="nc" id="L118">            String createStudentsTable = </span>
                &quot;CREATE TABLE IF NOT EXISTS students (&quot; +
                &quot;id BIGINT AUTO_INCREMENT PRIMARY KEY, &quot; +
                &quot;student_id VARCHAR(20) UNIQUE NOT NULL, &quot; +
                &quot;first_name VARCHAR(50) NOT NULL, &quot; +
                &quot;last_name VARCHAR(50) NOT NULL, &quot; +
                &quot;email VARCHAR(100) UNIQUE NOT NULL, &quot; +
                &quot;phone_number VARCHAR(20), &quot; +
                &quot;date_of_birth DATE, &quot; +
                &quot;program VARCHAR(100) NOT NULL, &quot; +
                &quot;year VARCHAR(10) NOT NULL, &quot; +
                &quot;status VARCHAR(20) DEFAULT 'ACTIVE', &quot; +
                &quot;enrollment_date DATE NOT NULL, &quot; +
                &quot;gpa DECIMAL(3,2) DEFAULT 0.00, &quot; +
                &quot;created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, &quot; +
                &quot;updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP&quot; +
                &quot;)&quot;;

<span class="nc" id="L136">            jdbcTemplate.execute(createStudentsTable);</span>

            // Insert sample data if table is empty
<span class="nc" id="L139">            Integer count = jdbcTemplate.queryForObject(&quot;SELECT COUNT(*) FROM students&quot;, Integer.class);</span>
<span class="nc bnc" id="L140" title="All 4 branches missed.">            if (count == null || count == 0) {</span>
<span class="nc" id="L141">                insertSampleData();</span>
            }
<span class="nc" id="L143">        }</span>

        private void insertSampleData() {
<span class="nc" id="L146">            String insertSQL = </span>
                &quot;INSERT INTO students (student_id, first_name, last_name, email, phone_number, &quot; +
                &quot;date_of_birth, program, year, status, enrollment_date, gpa) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;;

<span class="nc" id="L150">            Object[][] sampleData = {</span>
<span class="nc" id="L151">                {&quot;XTU20250001&quot;, &quot;John&quot;, &quot;Doe&quot;, &quot;john.doe@xashytech.edu&quot;, &quot;555-0101&quot;, &quot;2003-05-15&quot;, &quot;Computer Science&quot;, &quot;2&quot;, &quot;ACTIVE&quot;, &quot;2023-09-01&quot;, 3.75},</span>
<span class="nc" id="L152">                {&quot;XTU20250002&quot;, &quot;Jane&quot;, &quot;Smith&quot;, &quot;jane.smith@xashytech.edu&quot;, &quot;555-0102&quot;, &quot;2002-08-22&quot;, &quot;Software Engineering&quot;, &quot;3&quot;, &quot;ACTIVE&quot;, &quot;2022-09-01&quot;, 3.92},</span>
<span class="nc" id="L153">                {&quot;XTU20250003&quot;, &quot;Mike&quot;, &quot;Johnson&quot;, &quot;mike.johnson@xashytech.edu&quot;, &quot;555-0103&quot;, &quot;2004-01-10&quot;, &quot;Cybersecurity&quot;, &quot;1&quot;, &quot;ACTIVE&quot;, &quot;2024-09-01&quot;, 3.45},</span>
<span class="nc" id="L154">                {&quot;XTU20250004&quot;, &quot;Sarah&quot;, &quot;Williams&quot;, &quot;sarah.williams@xashytech.edu&quot;, &quot;555-0104&quot;, &quot;2001-12-03&quot;, &quot;Data Science&quot;, &quot;4&quot;, &quot;ACTIVE&quot;, &quot;2021-09-01&quot;, 3.88},</span>
<span class="nc" id="L155">                {&quot;XTU20250005&quot;, &quot;David&quot;, &quot;Brown&quot;, &quot;david.brown@xashytech.edu&quot;, &quot;555-0105&quot;, &quot;2003-07-18&quot;, &quot;DevOps Engineering&quot;, &quot;2&quot;, &quot;ACTIVE&quot;, &quot;2023-09-01&quot;, 3.67}</span>
            };

<span class="nc bnc" id="L158" title="All 2 branches missed.">            for (Object[] student : sampleData) {</span>
<span class="nc" id="L159">                jdbcTemplate.update(insertSQL, student);</span>
            }

<span class="nc" id="L162">            System.out.println(&quot;Sample data inserted successfully!&quot;);</span>
<span class="nc" id="L163">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>